import requests
import time
from datetime import datetime, timedelta

# ================= [ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ] =================
LINE_ACCESS_TOKEN = 'https://kabintify.site'
# =====================================================

def send_line_flex(day, subjects):
    """‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Flex ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤"""
    url = "https://api.line.me/v2/bot/message/broadcast"
    headers = {"Content-Type": "application/json", "Authorization": f"Bearer {LINE_ACCESS_TOKEN}"}
    
    subject_rows = []
    for s in subjects:
        subject_rows.append({
            "type": "box", "layout": "horizontal", "margin": "md",
            "contents": [
                {"type": "text", "text": s['time'], "size": "xs", "color": "#888888", "flex": 2},
                {"type": "text", "text": f"{s['name']}\n{s['teacher']}\n‡∏´‡πâ‡∏≠‡∏á {s['room']}", "size": "sm", "weight": "bold", "wrap": True, "flex": 5}
            ]
        })

    colors = {"‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå": "#FFB800", "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£": "#FF4B91", "‡∏û‡∏∏‡∏ò": "#00B900", "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ": "#FF7A00", "‡∏®‡∏∏‡∏Å‡∏£‡πå": "#0099FF"}
    
    payload = {
        "messages": [{
            "type": "flex", "altText": f"‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô{day}",
            "contents": {
                "type": "bubble",
                "header": {"type": "box", "layout": "vertical", "backgroundColor": colors.get(day, "#333333"), "contents": [{"type": "text", "text": "‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏ò.3/2", "weight": "bold", "color": "#FFFFFF", "size": "xl"}, {"type": "text", "text": f"‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô{day}", "color": "#FFFFFFCC", "size": "sm"}]},
                "body": {"type": "box", "layout": "vertical", "contents": [{"type": "text", "text": "‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ", "weight": "bold", "size": "md"}, {"type": "separator", "margin": "md"}, {"type": "box", "layout": "vertical", "margin": "md", "contents": subject_rows}]}
            }
        }]
    }
    requests.post(url, headers=headers, json=payload)

def send_line_text(text):
    """‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Ñ‡∏≤‡∏ö‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥"""
    url = "https://api.line.me/v2/bot/message/broadcast"
    headers = {"Content-Type": "application/json", "Authorization": f"Bearer {LINE_ACCESS_TOKEN}"}
    payload = {
        "messages": [{"type": "text", "text": text}]
    }
    requests.post(url, headers=headers, json=payload)

def get_thai_day():
    """‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢"""
    days = {
        "Monday": "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "Tuesday": "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "Wednesday": "‡∏û‡∏∏‡∏ò",
        "Thursday": "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "Friday": "‡∏®‡∏∏‡∏Å‡∏£‡πå", "Saturday": "‡πÄ‡∏™‡∏≤‡∏£‡πå", "Sunday": "‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå"
    }
    return days.get(datetime.now().strftime("%A"))

# --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡πÑ‡∏ó‡∏¢) ---
day_subjects = {
    "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå": [{"time": "08:10-10:00", "name": "20204-2008 ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏°‡∏ì‡∏ë‡∏≤", "room": "432"}, {"time": "13:00-15:00", "name": "20204-2106 ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥", "teacher": "‡∏Ñ‡∏£‡∏π‡∏û‡∏£‡∏û‡∏¥‡∏á‡∏Ñ‡πå", "room": "434"}, {"time": "15:00-16:00", "name": "20204-8501 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", "room": "443"}],
    "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£": [{"time": "08:10-10:00", "name": "20000-1204 ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô", "teacher": "‡∏Ñ‡∏£‡∏π‡∏†‡∏≤‡∏ì‡∏∏‡∏û‡∏á‡∏©‡πå", "room": "123"}, {"time": "13:00-14:00", "name": "20000-1502 ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ä‡∏≤‡∏ï‡∏¥‡πÑ‡∏ó‡∏¢", "teacher": "‡∏Ñ‡∏£‡∏π‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏≤", "room": "136"}],
    "‡∏û‡∏∏‡∏ò": [{"time": "08:10-11:00", "name": "20000-1303 ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ô‡∏†‡∏™‡∏£", "room": "137"}, {"time": "13:00-14:00", "name": "Home Room", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", "room": "443"}, {"time": "14:00-16:00", "name": "20000-2007 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏° ‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", "room": "443"}],
    "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ": [{"time": "08:10-10:00", "name": "20000-1208 ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", "teacher": "‡∏Ñ‡∏£‡∏π‡∏≠‡∏ä‡∏¥‡∏ï‡∏≤", "room": "122"}, {"time": "10:00-12:00", "name": "20204-2106 ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥", "teacher": "‡∏Ñ‡∏£‡∏π‡∏û‡∏£‡∏û‡∏¥‡∏á‡∏Ñ‡πå", "room": "434"}, {"time": "13:00-15:00", "name": "20204-2008 ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏°‡∏ì‡∏ë‡∏≤", "room": "432"}, {"time": "15:00-16:00", "name": "20204-8501 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", "room": "443"}],
    "‡∏®‡∏∏‡∏Å‡∏£‡πå": [{"time": "08:10-10:00", "name": "20001-1001 ‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏∞‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", "teacher": "‡∏Ñ‡∏£‡∏π‡∏Å‡∏©‡∏≤‡∏õ‡∏ì‡πå", "room": "‡πÇ‡∏î‡∏°"}, {"time": "12:00-15:00", "name": "20001-1003 ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£", "teacher": "‡∏Ñ‡∏£‡∏π‡∏ô‡∏¥‡∏ï‡∏¥‡∏¢‡∏≤", "room": "441"}]
}

# --- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Ñ‡∏≤‡∏ö (‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE) ---
text_reminders = {
    "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå": {"08:10": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏°‡∏ì‡∏ë‡∏≤)", "13:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏Ñ‡∏£‡∏π‡∏û‡∏£‡∏û‡∏¥‡∏á‡∏Ñ‡πå)", "15:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤)"},
    "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£": {"08:10": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (‡∏Ñ‡∏£‡∏π‡∏†‡∏≤‡∏ì‡∏∏‡∏û‡∏á‡∏©‡πå)", "13:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ä‡∏≤‡∏ï‡∏¥‡πÑ‡∏ó‡∏¢ (‡∏Ñ‡∏£‡∏π‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏≤)"},
    "‡∏û‡∏∏‡∏ò": {"08:10": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏Ñ‡∏£‡∏π‡∏ô‡∏†‡∏™‡∏£)", "13:00": "üì¢ Home Room (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤)", "14:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏° ‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏° (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤)"},
    "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ": {"08:10": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏£‡∏π‡∏≠‡∏ä‡∏¥‡∏ï‡∏≤)", "10:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏Ñ‡∏£‡∏π‡∏û‡∏£‡∏û‡∏¥‡∏á‡∏Ñ‡πå)", "13:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏°‡∏ì‡∏ë‡∏≤)", "15:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤)"},
    "‡∏®‡∏∏‡∏Å‡∏£‡πå": {"08:10": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏∞‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏Ñ‡∏£‡∏π‡∏Å‡∏©‡∏≤‡∏õ‡∏ì‡πå)", "12:00": "üì¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ (‡∏Ñ‡∏£‡∏π‡∏ô‡∏¥‡∏ï‡∏¥‡∏¢‡∏≤)"}
}

def get_next_event():
    now = datetime.now()
    day_thai = get_thai_day()
    
    today_times = ["07:30"] # ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡πâ‡∏≤
    if day_thai in text_reminders:
        today_times.extend(text_reminders[day_thai].keys())
    
    future_events = []
    for t_str in sorted(list(set(today_times))):
        target = now.replace(hour=int(t_str[:2]), minute=int(t_str[3:]), second=0, microsecond=0)
        if target > now:
            future_events.append((target, t_str))
            
    if not future_events:
        next_day = now + timedelta(days=1)
        target = next_day.replace(hour=7, minute=30, second=0, microsecond=0)
        return target, "07:30"
    
    return future_events[0]

if __name__ == "__main__":
    print(">>> ‡∏ö‡∏≠‡∏ó Kabintify ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô...")
    while True:
        target_dt, t_str = get_next_event()
        wait_seconds = (target_dt - datetime.now()).total_seconds()
        
        print(f"[{datetime.now().strftime('%H:%M:%S')}] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏≠‡∏ô‡∏£‡∏≠‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: {t_str} (‡∏≠‡∏µ‡∏Å {wait_seconds/60:.1f} ‡∏ô‡∏≤‡∏ó‡∏µ)")
        time.sleep(max(0, wait_seconds)) # ‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö
        
        day_thai = get_thai_day()
        if t_str == "07:30":
            if day_thai in day_subjects:
                send_line_flex(day_thai, day_subjects[day_thai])
        elif day_thai in text_reminders and t_str in text_reminders[day_thai]:
            send_line_text(text_reminders[day_thai][t_str])
        
        time.sleep(2)
